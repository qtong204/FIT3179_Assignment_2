{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "width": 1000,
  "height": 700,
  "title": "ASEAN Environmental Indicators (2010-2020)",
  "params": [
    {
      "name": "selectedYear",
      "value": 2020,
      "bind": {
        "input": "select",
        "options": [
          2010,2011,2012,2013,2014,2015,2016,
          2017,2018,2019,2020
        ],
        "name": "Select Year: "
      }
    },
    {
      "name": "selectedIndicator",
      "value": "CO2_Emissions_Total",
      "bind": {
        "input": "select",
        "options": [
          "CO2_Emissions_Total",
          "GHG_Emissions_Total",
          "PM25_Exposure",
          "Renewable_Energy_%"
        ],
        "labels": [
          "CO₂ Emissions (Mt)",
          "GHG Emissions (Mt)",
          "PM₂.₅ Exposure (µg/m³)",
          "Renewable Energy (%)"
        ],
        "name": "Select Indicator: "
      }
    }
  ],
  "data": {
    "url": "https://raw.githubusercontent.com/qtong204/FIT3179_Assignment_2/refs/heads/main/ASEAN_economy_climate.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {"calculate": "toNumber(datum.Year)", "as": "Year"},
    {"filter": "datum.Year == selectedYear"},
    {
      "lookup": "Country",
      "from": {
        "data": {
          "url": "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson",
          "format": {"type": "json", "property": "features"}
        },
        "key": "properties.name"
      },
      "as": "geo"
    },
    {
      "calculate": "datum[selectedIndicator]",
      "as": "SelectedValue"
    }
  ],
  "projection": {"type": "mercator", "center": [115, 5], "scale": 600},
  "mark": {"type": "geoshape", "stroke": "white", "strokeWidth": 1},
  "encoding": {
    "shape": {"field": "geo", "type": "geojson"},
    "color": {
      "field": "SelectedValue",
      "type": "quantitative",
      "title": {
        "expr": "selectedIndicator == 'CO2_Emissions_Total' ? 'CO₂ Emissions (Mt)' : selectedIndicator == 'GHG_Emissions_Total' ? 'GHG Emissions (Mt)' : selectedIndicator == 'PM25_Exposure' ? 'PM₂.₅ Exposure (µg/m³)' : 'Renewable Energy (%)'"
      },
      "scale": {
        "scheme": "reds"
      },
      "legend": {
        "orient": "right",
        "titleFontSize": 14,
        "titleFontWeight": "bold",
        "labelFontSize": 11,
        "titlePadding": 8,
        "offset": 10,
        "direction": "vertical",
        "gradientLength": 300,
        "format": {
          "expr": "selectedIndicator == 'CO2_Emissions_Total' || selectedIndicator == 'GHG_Emissions_Total' ? '.0f' : selectedIndicator == 'PM25_Exposure' ? '.1f' : '.1f'"
        }
      }
    },
    "tooltip": [
      {"field": "Country", "title": "Country"},
      {"field": "Year", "title": "Year"},
      {"field": "CO2_Emissions_Total", "title": "CO₂ Emissions (Mt)", "format": ".2f"},
      {"field": "GHG_Emissions_Total", "title": "GHG Emissions (Mt)", "format": ".2f"},
      {"field": "PM25_Exposure", "title": "PM₂.₅ Exposure (µg/m³)", "format": ".2f"},
      {"field": "Renewable_Energy_%", "title": "Renewable Energy (%)", "format": ".1f"}
    ]
  },
  "config": {
    "background": "white",
    "view": {"stroke": "transparent"},
    "legend": {"titleFontWeight": "bold"}
  }
}
